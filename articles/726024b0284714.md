---
title: "ã€MySQLã€‘ã¾ã¨ã‚ã¦updateå‡¦ç†ã—ãŸã„"
emoji: "ğŸ’­"
type: "tech"
topics:
  - "mysql"
published: true
published_at: "2022-08-08 14:38"
---

:::message alert
ã“ã®è¨˜äº‹ã¯è‡ªåˆ†ãŒç¤¾å†…ã§ã¾ã¨ã‚ã¦ã„ãŸã‚‚ã®ã‚’è»¢è¼‰ã—ã¦ãŠã‚Šã¾ã™ã€‚
æƒ…å ±ãŒå¤ã„æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚ã”äº†æ‰¿ãã ã•ã„ã€‚
æŠ•ç¨¿æ—¥ï¼š2018/12/21
:::

ã‚ã‚Šã¨çµæ§‹ãªå›æ•°ã€åŒã˜ã‚ˆã†ãªupdateå‡¦ç†ã‚’ã—ãªã„ã¨ã„ã‘ãªããªã‚Šã¾ã—ãŸã€‚
æœ€åˆã€ãƒ«ãƒ¼ãƒ—ã§ä½•åº¦ã‚‚updateå‡¦ç†ã‚’ã•ã›ã‚‹ã€ã¨ã„ã†ã®ã‚’æƒ³åƒã—ãŸã®ã§ã™ãŒ
ã‚‚ã£ã¨ã‹ã£ã“ã‚ˆã„updateæ–¹æ³•ãªã„ã‹ãªï¼Ÿ
ã¨æ€ã£ã¦ã„ã‚ã„ã‚èª¿ã¹ãŸã‚‰ã‚ã‚Šã¾ã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

## ç’°å¢ƒ
- MySQL 5.6

## UPDATEå‡¦ç†

```sql
UPDATE {ãƒ†ãƒ¼ãƒ–ãƒ«å} SET columnA = ELT(FIELD(columnB, 1, 2, 3, ...), A, B, C, ...) WHERE columnB IN (1, 2, 3, ...);
```

â€»ã“ã®æ–¹æ³•ã€EC-CUBEã§å®Ÿç¾ã•ã›ã‚‹ãŸã‚ã«ã¯ã€updateãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ãªãSQLæ–‡ã‚’ã„ã¡ã‹ã‚‰ä½œã‚‹ã—ã‹ãªã„ã§ã™

è¦‹æ…£ã‚Œãªã„é–¢æ•°ã ã£ãŸã®ã§ä»¥ä¸‹ã€ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹è²¼ã‚Šã¾ã™

## ELT()
https://dev.mysql.com/doc/refman/5.6/ja/string-functions.html#function_elt


> ELT() ã¯ã€æ–‡å­—åˆ—ãƒªã‚¹ãƒˆã® N ç•ªç›®ã®è¦ç´ ã‚’è¿”ã—ã¾ã™ã€‚
>N = 1 ã®å ´åˆã¯ str1ã€N = 2 ã®å ´åˆã¯ str2 ã®ã‚ˆã†ã«è¿”ã—ã¾ã™ã€‚
>N ãŒ 1 ã‚ˆã‚Šã‚‚å°ã•ã„ã‹ã€å¼•æ•°ã®æ•°ã‚ˆã‚Šã‚‚å¤§ãã„å ´åˆã¯ã€NULL ã‚’è¿”ã—ã¾ã™ã€‚
>ELT() ã¯ FIELD() ã®è£œæ•°ã§ã™ã€‚

```sql
mysql> SELECT ELT(1, 'ej', 'Heja', 'hej', 'foo');
        -> 'ej'
mysql> SELECT ELT(4, 'ej', 'Heja', 'hej', 'foo');
        -> 'foo'
```

## FIELD()

https://dev.mysql.com/doc/refman/5.6/ja/string-functions.html#function_field


> str1ã€str2ã€str3ã€... ãƒªã‚¹ãƒˆå†…ã§ str ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ (ä½ç½®) ã‚’è¿”ã—ã¾ã™ã€‚str ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€0 ã‚’è¿”ã—ã¾ã™ã€‚
> 
> FIELD() ã¸ã®ã™ã¹ã¦ã®å¼•æ•°ãŒæ–‡å­—åˆ—ã®å ´åˆã¯ã€ã™ã¹ã¦ã®å¼•æ•°ãŒæ–‡å­—åˆ—ã¨ã—ã¦æ¯”è¼ƒã•ã‚Œã¾ã™ã€‚ã™ã¹ã¦ã®å¼•æ•°ãŒæ•°å€¤ã®å ´åˆã¯ã€æ•°å­—ã¨ã—ã¦æ¯”è¼ƒã•ã‚Œã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã¯ã€å¼•æ•°ãŒå€ç²¾åº¦ã¨ã—ã¦æ¯”è¼ƒã•ã‚Œã¾ã™ã€‚
> 
> NULL ã§ã¯ã©ã®å€¤ã¨ã®ç­‰ä¾¡æ¯”è¼ƒã«ã‚‚å¤±æ•—ã™ã‚‹ãŸã‚ã€str ãŒ NULL ã§ã‚ã‚‹å ´åˆã¯ã€æˆ»ã‚Šå€¤ãŒ 0 ã«ãªã‚Šã¾ã™ã€‚FIELD() ã¯ ELT() ã®è£œæ•°ã§ã™ã€‚





```sql
mysql> SELECT FIELD('ej', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -> 2
mysql> SELECT FIELD('fo', 'Hej', 'ej', 'Heja', 'hej', 'foo');
        -> 0
```



## å‚è€ƒ

 [MySQLã§ãƒãƒ«ã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’å®Ÿç¾ã™ã‚‹ã«ã¯](https://qiita.com/maxima/items/ee87d9bea31eddf667e0) 